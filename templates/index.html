<!DOCTYPE html>
<html lang="en">
<head>
    <title>Court Science</title>
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet" type="text/css">
     <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
    <script src="{{ url_for('static', filename='papaparse.min.js') }}"></script>
</head>
<body>
    <div class="navigation-bar">
        <ul class="navigation-bar">
            <li class="navigation-bar-item"><a href="#home">HOME</a></li>
            <li class="navigation-bar-item"><a href="#demo">DEMO</a></li>
            <li class="navigation-bar-item"><a href="#contact">CONTACT</a></li>
            <li><div class="logo"><img src="{{ url_for('static', filename='Nuclear_Court Science Logo.png') }}"
                                       width="200"></div></li>
        </ul>
    </div>
    <div class="body-section-top" id="home">
        <h2 class="title">WHO WE ARE</h2>
        <p class="body-text">
            Court Science is a web-based platform that makes the power of data science accessible
            to basketball players, coaches, and leagues worldwide. We aim to bridge the gap
            between STEM and sports, by leveraging data science to provide basketball enthusiasts
            with key data insights including visualizations, boosting their game to the next level.
            We're currently in our early stages of development, so please try out our demo and tell
            us what you think below!
        </p>
    </div>
    <div class="body-section-2" id="demo">
        <h2 class="title">TRY IT NOW</h2>
        <ol class="list-text">
            <li>Upload a csv file of your stats with the following format:</li>
                <ul>
                    <img class="spreadsheet" src="{{ url_for('static', filename='Screenshot (1).png') }}">
                    <li>The first 4 columns must contain general player info with mandatory labels at the top row: <b>"FULL NAME"</b>,
                    <b>"TEAM"</b>, <b>"POS"</b>, and <b>"AGE"</b>.</li>
                    <li>The rest of the columns can contain stats of your choice from the following label options: <b>"FTA"</b>,
                    <b>"FT%"</b>, <b>"2PA"</b>, <b>"2P%"</b>, <b>"3PA"</b>, <b>"3P%"</b>, <b>"PPG"</b>,
                    <b>"APG"</b>, <b>"RPG"</b>, <b>"SPG"</b>, <b>"BPG"</b></li>
                    <li>Ensure all labels are spelled exactly the same as above (case sensitive).</li>
                    <li>Leave boxes with missing info empty.</li>
                    <li>Once ready, download your spreadsheet as a CSV and upload it.</li>
                    <li>Don't have a spreadsheet? No problem, <a
                            href="https://storage.cloud.google.com/statsheet-storage-bucket/Sample.xlsx%20-%20Sheet1.csv" download>
                        <b>download our sample sheet</b></a>!</li>
                </ul>
            <li>Select the features you would like to visualize</li>
            <li>Click the "Submit" button to view your data visualized!</li>
        </ol><br><br>
        <form id="input-form" action="{{ url_for('main')}}" method="post" enctype="multipart/form-data">
            <p class="form-text"><b>Select a file:</b></p><br>
            <input type="file" id="test" name="myCSV" accept=".csv"><br><br>
        </form>
    </div>
    <div id="contact" class="body-section-1">
        <h2 class="title">GET IN TOUCH</h2>
        <p class="body-text">
            We would love to hear from you, send us a shout below!
        </p>
        <a href="mailto:contact@courtscience.ca">
            <img alt="email" class="email-button"
                 src="https://farm4.staticflickr.com/3726/13855354235_887ae071c0_b.jpg">
        </a>
    </div>
<script>
    const inputElement = document.getElementById("test");
    inputElement.addEventListener("change", handleFiles, false);
    function handleFiles() {
        const inputCSV = this.files[0];
        Papa.parse(inputCSV, {
	        complete: function(results) {
                let headers = results['data'][0];
                let sample_data = results['data'][1];
                let num_str = "0123456789";
                let headers_filtered = [];
                let count = 1;

                for (let i = 0; i < headers.length; i++) {
                    if (num_str.includes(sample_data[i][0])) {
                        headers_filtered.push(headers[i]);
                    }
                }

                console.log(headers_filtered);

                let html_form = document.getElementById("input-form");
                html_form.insertAdjacentHTML('beforeend', "<p class='form-text'><b>Select 5 applicable stats to visualize:</b></p><br>");


                for (const element of headers_filtered) {
                    let name = "'stat" + String(count) + "'";
                    let string_to_add = "<input type='checkbox' name=" + name + " value=" + "'"+ element + "'>" + element + "<br>\n" + "<input type='hidden' name=" + name + " value='false'>";
                    console.log(string_to_add);
                    html_form.insertAdjacentHTML('beforeend', string_to_add);
                    count += 1;
                }

                html_form.insertAdjacentHTML('beforeend', "<input type='submit' value='Submit'>\n" + "<input type='reset'>");
            }
        });
    }
</script>
</body>
</html>